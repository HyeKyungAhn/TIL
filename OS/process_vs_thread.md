# Process와 Thread의 관계

## Process란?

Microsoft 사의 문서 편집기인 Word가 있다. 이 소프트웨어의 파일(word.exe)을 우리는 'Program'이라고 한다. 프로세스(process)는 이 프로그램이 메모리에 할당되어 실행 중인 상태를 의미한다. 즉 **실행 중인 프로그램**을 프로세스라고 한다. Process는 Task라는 개념적 표현으로 부르기도 한다.

## Thread란?

Process를 조금 다르게 표현한다면 프로세스는 OS가 수행하는 연산 작업의 '단위'이다. word.exe 파일에 작성된 코드들을 읽고 '연속'적으로 연산작업을 수행하는데 이때 연산 작업의 흐름이 발생한다. 이때의 흐름은 하나일 수도, 여러개가 동시에 독립적으로 존재할 수도 있다(multi-threading). 이 때의 개별적인 흐름을 Thread라고 한다. Thread는 실제 작업을 수행하는 **실행 작업의 단위**이다.

## 가상 메모리

process가 연산을 할 때 필요한 것들이 있다. 연산을 수행하는 CPU와 input, output, 명령어, 중간값 등을 저장하고 불러오는 RAM 등이 필요하다. 연산을 할 때 process가 앞의 두 하드웨어들에 접근하는 것은 아니고 OS가 중개를 해준다.

program을 실행할 때 OS는 process에 가상 메모리(virtual memory)를 제공한다. process에 주 기억장치인 RAM을 바로 할당하는게 아니라 가상메모리의 일부 공간을 할당하는 것이다. 그럼 가상 메모리가 뭘까? RAM, 하드디스크를 하나의 논리적 메모리로 추상화한 것을 말한다.

OS는 process들에게 일반적으로 4GB 또는 그 이상의 메모리 공간을 사용할 수 있다고 알려준다. 하지만 실제 process들이 사용하는 공간은 그것보다 작고 한정되어있다. 또 컴퓨터에서 실행되는 process들은 200개 이상이고 이 안에서 실행되는 thread 들은 2000개 이상이다. 이 모든 process가 4GB들을 모두 사용하는 것은 보통의 컴퓨터에서는 불가능한 일이다. 그렇기 때문에 process는 한정된 메모리 공간을 나눠서 효율적으로 사용해야한다. 따라서 제한된 메모리 자원을 효율적으로 사용하기 위해서 RAM, HDD를 추상화한 가상 메모리를 사용하는 것이다. 그리고 이 가상 메모리를 나누고 할당, 회수, 관리 스케줄링 하는 역할을 운영체제가 한다.

## process와 thread의 관계

OS는 process에 가상 메모리의 일부를 할당한다. 이때 할당하는 가상 메모리의 단위는 page이다. process 내의 개별 흐름인 thread는 process 내에 최소 1개가 존재한다. process와 thread의 관계는 가족과 가족 구성원에 비유할 수 있다.

가족과 그 가족이 사는 집이 있다고 예를 들어보자. 가족의 구성원은 4명이고 집 안에 각자의 방이 있다. 각자의 사생활을 위해 서로의 방에 들어가지는 않지만 공용공간(거실, 화장실, 주방)이 있어 함께 사용하기도 한다.

process는 가족이고 집은 process가 할당받은 가상 메모리 공간, thread는 가족 구성원에 비유할 수 있다. thread의 메모리 공간은 process가 할당 받은 가상 메모리 공간내로 제한된다. thread는 각자의 공간(Thread Local Storage, stack 구조)가 있고 또 함께 사용하는 공용 공간(heap) 도 있다.
